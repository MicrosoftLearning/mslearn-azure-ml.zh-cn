---
lab:
  title: 了解 Azure 机器学习工作区
---

# 了解 Azure 机器学习工作区

Azure 机器学习提供了一个用于训练和管理机器学习模型的数据科学平台。 在此实验室中，你将创建一个 Azure 机器学习工作区，并探索使用该工作区的各种方式。 该实验室旨在介绍 Azure 机器学习的各种核心功能和开发人员工具。 如果想要更深入地了解这些功能，可以探索其他实验室。

## 准备工作

需要一个你在其中具有管理级权限的 [Azure 订阅](https://azure.microsoft.com/free?azure-portal=true)。

## 预配 Azure 机器学习工作区

借助 Azure 机器学习工作区，可集中管理训练和管理模型所需的所有资源和资产。 可以使用 Azure 门户中的交互式界面预配工作区，也可以将 Azure CLI 与 Azure 机器学习扩展配合使用。 在大多数生产场景中，最好使用 CLI 自动预配，以便可以将资源部署整合到可重复的开发和操作 (DevOps) 过程中。 

在本练习中，你将使用 Azure 门户预配 Azure 机器学习，以探索所有选项。

1. 登录到 `https://portal.azure.com/`。
2. 使用以下设置创建新的“Azure 机器学习”资源：
    - **订阅**：Azure 订阅
    - **资源组**：`rg-dp100-labs`
    - 工作区名称：`mlw-dp100-labs`
    - 区域：选择最靠近你的地理区域
    - 存储帐户：请记下要为工作区创建的默认新存储帐户
    - 密钥保管库：请记下要为工作区创建的默认新密钥保管库
    - Application Insights：请记下要为工作区创建的默认新 Application Insights
    - 容器注册表：无（第一次将模型部署到容器时，将自动创建一个）
3. 等待创建工作区及其关联资源 - 这通常需要大约 5 分钟。

> **注意**：创建 Azure 机器学习工作区时，可以使用一些高级选项来限制通过专用终结点的访问，并指定用于数据加密的自定义密钥。 本练习中不使用这些选项，但你应该知道有这些选项。

## 浏览 Azure 机器学习工作室

Azure 机器学习工作室是一个基于 Web 的门户，可通过其访问 Azure 机器学习工作区。 可以使用 Azure 机器学习工作室来管理工作区内的所有资产和资源。

1. 转到名为“rg-dp100-labs”的资源组。
1. 确认资源组包含 Azure 机器学习工作区、Application Insights、Key Vault 和存储帐户。
1. 选择你的 Azure 机器学习工作区。
1. 从“概述”页面选择“启动工作室” 。 将在浏览器中打开另一标签页，以打开 Azure 机器学习工作室。
1. 关闭工作室中显示的任何弹出窗口。
1. 请注意工作室左侧显示的不同页面。 如果菜单中只显示符号，请选择 &#9776; 图标展开菜单并浏览页面的名称。
1. 请注意“**创作**”部分，其中包括“**Notebooks**”、“**自动化 ML**”和“**设计器**”。 可以通过以下三种方式在 Azure 机器学习工作室中创建自己的机器学习模型。
1. 请注意“资产”部分，其中包括“数据”、“作业”和“模型”等   。 在对模型进行训练或评分时，资产会被消耗或创建。 资产用于训练、部署和管理模型，并且可以进行版本控制以跟踪历史记录。
1. 请注意“**管理**”部分，其中包括“**计算**”等内容。 这些是训练或部署机器学习模型所需的基础结构资源。

## 使用 AutoML 训练模型

要探索 Azure 机器学习工作区中资产和资源的使用，让我们尝试训练一个模型。

使用 **AutoML** 选项快速训练和查找基于数据的任务的最佳模型。

> **注意**：弹出窗口可能会出现在整个过程中，以引导你完成整个工作室。 可以关闭并忽略所有弹出窗口，并专注于本实验室的说明。

1. 下载将用于 `https://github.com/MicrosoftLearning/mslearn-azure-ml/raw/refs/heads/main/Labs/02/diabetes-data.zip` 并提取压缩文件的训练数据。
1. 回到 Azure 机器学习工作室，从工作室左侧的菜单中选择 **AutoML** 页面。
1. 选择“**+ 新建自动化 ML 作业**”。
1. 在“**基本设置**”步骤中，为训练作业和试验提供唯一的名称，或使用分配的默认值。 选择**下一步**。
1. 在“**任务类型和数据**”步骤中，选择“**分类**”作为任务类型，然后选择“**+ 创建**”以添加训练数据。
2. 在“**创建数据资产**”页上的“**数据类型**”步骤中，为数据资产命名（例如 `training-data`），然后选择“**下一步**”。
1. 在“**数据源**”步骤中，选择“**从本地文件**”上传之前下载的训练数据。 选择**下一步**。
1. 在“**目标存储类型**”步骤中，验证是否选择了 **Azure Blob 存储**作为数据存储类型，并且是否选择了 **workspaceblobstore**。 选择**下一步**。
1. 在“**MLTable 选择**”步骤中，选择“**上传文件夹**”，然后选择从之前下载的压缩文件中提取的文件夹。 选择**下一步**。
1. 查看数据资产的设置，然后选择“**创建**”。
1. 返回“**任务类型和数据**”步骤，选择刚刚上传的数据，然后选择“**下一步**”。

> **提示**：在转到下一步之前，可能需要再次选择“**分类**”任务类型。

1. 在“**任务设置**”步骤中，选择“**糖尿病（布尔值）**”作为目标列，然后打开“**查看其他配置设置**”选项。
1. 在“**其他配置**”窗格中，将主要指标更改为“**准确度**”，然后选择“**保存**”。
1. 展开“**限制**”选项并设置以下属性：
    * **最大试用数**: 10
    * **试验超时（分钟）**：60
    * **迭代超时（分钟）**：15
    * **启用提前终止**：已选中

1. 对于“**测试数据**”，请选择“**训练测试拆分**”，并验证“**数据测试百分比**”是否为 10。 选择**下一步**。
1. 在“**计算**”步骤中，验证计算类型是否为“**无服务**”、所选虚拟机大小是否为 **Standard_DS3_v2**。 选择**下一步**。

> **注意**：计算实例和群集是基于标准 Azure 虚拟机映像的。 对于本练习，建议使用 *Standard_DS3_v2* 图像来实现成本和性能的最佳平衡。 如果你的订阅配额不包含此映像，请选择其他映像；但请注意，较大的映像可能会产生较高的成本，而较小的映像可能不足以完成任务。 或者，让 Azure 管理员扩展配额。

1. 查看设置并选择“**提交训练作业**”。

## 使用作业查看历史记录

提交作业后，将重定向到作业的页面。 使用作业可以跟踪运行的工作负载，并将它们相互比较。 作业属于“试验”，因此可以将作业运行进行分组。 

1. 请注意，在“**概述**”参数中，可以找到作业的状态、创建者、创建时间和运行时间（以及其他信息）。
1. 训练作业需要 10-20 分钟才能完成。 作业完成后，还可以单独查看每个组件运行的详细信息，包括输出。 可随时浏览“作业”页，以了解模型的训练方式。

    Azure 机器学习还会自动跟踪作业的属性。 通过使用工作，可以轻松查看历史记录以了解你或同事已经完成的操作。
    在实验期间，作业有助于跟踪训练的不同模型，以比较和确定最佳模型。 在生产期间，通过作业可以检查自动化工作负载是否按预期运行。

## 删除 Azure 资源

当你完成对 Azure 机器学习的探索时，应删除已创建的资源，以避免产生不必要的 Azure 成本。

1. 关闭“Azure 机器学习工作室”选项卡并返回到 Azure 门户。
1. 在 Azure 门户的**主页**上，选择“资源组”。
1. 选择“rg-dp100-labs”资源组。
1. 在资源组的“概述”页的顶部，选择“删除资源组”。
1. 输入资源组名称以确认要删除该资源组，然后选择“删除”。
